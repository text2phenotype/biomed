import unittest

import numpy
from text2phenotype.common.featureset_annotations import Vectorization, MachineAnnotation

from text2phenotype.constants.features import FeatureType

from biomed.common.matrix_construction import get_3d_matrix


class TestFeaturesetVectorization(unittest.TestCase):
    TEST_TOKEN = MachineAnnotation(json_dict_input={'date_comprehension': {4: [{'since_first': 0, 'before_last': 2923974, 'temporal': -1, 'rank': 0}],
                                         5: [{'since_first': 0, 'before_last': 2923974, 'temporal': -1, 'rank': 0}],
                                         8: [{'since_first': 2246, 'before_last': 2921728, 'temporal': -1, 'rank': 1}],
                                         9: [{'since_first': 2246, 'before_last': 2921728, 'temporal': -1, 'rank': 1}],
                                         10: [{'since_first': 2246, 'before_last': 2921728, 'temporal': -1, 'rank': 1}],
                                         13: [{'since_first': 2923974, 'before_last': 0, 'temporal': None, 'rank': 2}],
                                         14: [{'since_first': 2923974, 'before_last': 0, 'temporal': None, 'rank': 2}],
                                         15: [{'since_first': 2923974, 'before_last': 0, 'temporal': None, 'rank': 2}]},
                  'token': ['patient', 'X', 'presented', 'on', '07/08/93', ',', 'recurrent', 'in', 'September', '1999',
                            ',', 'final', 'incident', '1', 'February', ',', '2016'],
                  'len': [7, 1, 9, 2, 8, 1, 9, 2, 9, 4, 1, 5, 8, 1, 8, 1, 4],
                  'speech': ['JJ', 'NNP', 'VBD', 'IN', 'CD', ',', 'NN', 'IN', 'NNP', 'CD', ',', 'JJ', 'NN', 'CD', 'NNP',
                             ',', 'CD'],
                  'speech_bin': ['Adjectives', 'Nouns', 'Verbs', 'com_dep_wd', 'Numbers', 'unknown', 'Nouns',
                                 'com_dep_wd', 'Nouns', 'Numbers', 'unknown', 'Adjectives', 'Nouns', 'Numbers', 'Nouns',
                                 'unknown', 'Numbers'],
                  'range': [[0, 7], [8, 9], [10, 19], [20, 22], [23, 31], [31, 32], [33, 42], [43, 45], [46, 55],
                            [56, 60], [60, 61], [62, 67], [68, 76], [77, 78], [79, 87], [87, 88], [89, 93]]})
    VECTORS = Vectorization(json_input_dict={'address': {}, 'header': {}, 'drug_rxnorm': {}, 'lab_hepc': {}, 'clinical': {},
               'person': {}, 'zipcode': {}, 'aspect': {}, 'history': {}, 'polarity': {}, 'severity': {},
               'sectionizer': {}, 'form': {},
               'len': {0: [0, 1, 0], 1: [1, 0, 0], 2: [0, 1, 0], 3: [1, 0, 0], 4: [0, 1, 0], 5: [1, 0, 0], 6: [0, 1, 0],
                       7: [1, 0, 0], 8: [0, 1, 0], 9: [0, 1, 0], 10: [1, 0, 0], 11: [0, 1, 0], 12: [0, 1, 0],
                       13: [1, 0, 0], 14: [0, 1, 0], 15: [1, 0, 0], 16: [0, 1, 0]}, 'speech': {
            0: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            1: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            2: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            3: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            4: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            5: [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            6: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            7: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            8: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            9: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            10: [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            11: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            12: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            13: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            14: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            15: [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            16: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]},
               'speech_bin': {0: [0, 0, 0, 1, 0, 0, 0, 0, 0], 1: [0, 0, 0, 0, 1, 0, 0, 0, 0],
                              2: [0, 0, 0, 0, 0, 0, 1, 0, 0], 3: [0, 1, 0, 0, 0, 0, 0, 0, 0],
                              4: [0, 0, 0, 0, 0, 0, 0, 0, 1], 5: [1, 0, 0, 0, 0, 0, 0, 0, 0],
                              6: [0, 0, 0, 0, 1, 0, 0, 0, 0], 7: [0, 1, 0, 0, 0, 0, 0, 0, 0],
                              8: [0, 0, 0, 0, 1, 0, 0, 0, 0], 9: [0, 0, 0, 0, 0, 0, 0, 0, 1],
                              10: [1, 0, 0, 0, 0, 0, 0, 0, 0], 11: [0, 0, 0, 1, 0, 0, 0, 0, 0],
                              12: [0, 0, 0, 0, 1, 0, 0, 0, 0], 13: [0, 0, 0, 0, 0, 0, 0, 0, 1],
                              14: [0, 0, 0, 0, 1, 0, 0, 0, 0], 15: [1, 0, 0, 0, 0, 0, 0, 0, 0],
                              16: [0, 0, 0, 0, 0, 0, 0, 0, 1]}, 'header_aspect': {},
               'case': {0: [0, 1, 0], 1: [1, 0, 0], 2: [0, 1, 0], 3: [0, 1, 0], 6: [0, 1, 0], 7: [0, 1, 0],
                        8: [0, 0, 1], 11: [0, 1, 0], 12: [0, 1, 0], 14: [0, 0, 1]},
               'tf_i2b2': {0: [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 1: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           2: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 3: [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                           5: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 6: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           7: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 8: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           10: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 11: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           12: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13: [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
                           14: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 15: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]},
               'tf_ccda': {0: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 1: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           2: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 3: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           5: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           7: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 8: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           9: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           11: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 13: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                           15: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]},
               'tf_mtsample': {0: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 1: [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                               2: [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], 3: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                               5: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                               7: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                               9: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                               11: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 12: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                               13: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 14: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                               15: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]},
               'tf_mrconso': {0: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0], 1: [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                              2: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 3: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                              5: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 6: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                              7: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 8: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                              9: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 10: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                              11: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 12: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                              13: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 14: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                              15: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 16: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]},
               'tf_npi_city': {1: [1], 3: [1], 5: [1], 7: [1], 10: [1], 13: [1], 15: [1]},
               'tf_npi_address': {0: [1], 1: [1], 3: [1], 5: [1], 7: [1], 8: [1], 9: [1], 10: [1], 11: [1], 13: [1],
                                  14: [1], 15: [1], 16: [1]}, 'tf_npi_phone': {13: [1]},
               'tf_npi_first_name': {0: [1], 1: [1], 3: [1], 5: [1], 7: [1], 8: [1], 10: [1], 13: [1], 14: [1],
                                     15: [1]},
               'tf_npi_last_name': {1: [1], 3: [1], 5: [1], 7: [1], 8: [1], 10: [1], 14: [1], 15: [1]},
               'tf_patient_first_name': {3: [1], 7: [1], 8: [1], 13: [1]},
               'tf_patient_last_name': {0: [1], 3: [1], 7: [1], 13: [1], 14: [1]}, 'tf_cities': {},
               'tf_states': {7: [1]}, 'tf_disorder': {6: [1]}, 'tf_finding': {6: [1]}, 'tf_procedure': {0: [1]},
               'smoking': {}, 'clinical_code_icd9': {}, 'clinical_code_icd10': {}, 'clinical_general': {},
               'clinical_snomed': {}, 'regex_dates': {},
               'date_comprehension': {4: [1, 1, 0], 5: [1, 1, 0], 8: [1, 0, 0], 9: [1, 0, 0], 10: [1, 0, 0],
                                      13: [1, 0, 1], 14: [1, 0, 1], 15: [1, 0, 1]}, 'patient': {}, 'problem': {},
               'diagnosis': {}, 'lab_loinc': {},
               'word2vec_mimic': {
                   0: [0.00876586, 0.02914304, -0.00972933, 0.01848925, -0.01707641, -0.07729608, -0.05117268,
                       -0.05982628, 0.04043513, 0.12836689, -0.05722286, 0.03162089, -0.1416158, -0.1648948, 0.05352614,
                       -0.14546196, 0.12638307, -0.0089025, -0.00854798, -0.081788, -0.08217425, -0.00845774,
                       -0.01189998, -0.14412804, 0.01366086, -0.14247358, -0.09415042, 0.14359035, 0.1190358, 0.1364878,
                       0.01050632, 0.00387391, -0.11625509, 0.02060194, 0.15928861, 0.05918023, 0.24866292, -0.02390049,
                       0.19024956, 0.04748163, -0.0530531, 0.07924896, -0.04198221, -0.09305432, -0.00483033,
                       -0.18744874, -0.11867509, 0.01069315, -0.02195707, -0.01337967, 0.05406594, 0.11252288,
                       0.10944088, 0.10095187, -0.02149685, 0.12024253, 0.10484986, -0.05899455, -0.09396501,
                       0.04290322, -0.18619609, -0.05912491, 0.03093875, 0.04662116, -0.05973517, -0.0664169,
                       -0.09485929, -0.00681112, -0.01049359, -0.1073202, 0.06371934, 0.14863108, -0.03566135,
                       0.0192219, -0.1268345, -0.05571074, -0.04435457, -0.07964122, -0.08427533, 0.08771247,
                       0.12502173, -0.09098209, -0.00285204, 0.0141314, -0.04881449, -0.00760563, 0.06132055,
                       0.10098483, 0.03146211, -0.00264234, -0.07572731, 0.02158162, -0.03157378, 0.0829301, 0.17662092,
                       0.06975314, -0.02111227, -0.11826894, 0.03434685, -0.0318994, 0.02584442, -0.09289145,
                       0.13375187, -0.03238613, -0.08544783, -0.01989731, 0.1221439, -0.02532939, -0.08501951,
                       -0.00772219, -0.08565625, 0.06296238, -0.2289513, 0.06249014, 0.19910897, -0.12429684,
                       0.08321279, 0.03018787, -0.04715918, -0.04374395, 0.06914263, 0.06030294, -0.00485749,
                       -0.04217584, 0.02043408, -0.10797925, 0.05730338, 0.02611108],
                   1: [-0.06549577, -0.04569874, -0.03987939, 0.12327045, 0.00072087, 0.0597484, 0.01230616, -0.2031565,
                       -0.02212462, -0.05096206, -0.19321015, 0.0287394, -0.02932696, -0.24258502, -0.03651026,
                       0.02473692, 0.05505484, 0.00739732, 0.12435417, -0.08829825, -0.141812, 0.04358238, -0.0697438,
                       -0.06297644, 0.0641388, -0.09097411, 0.03668144, -0.04851188, -0.01425338, 0.06468557,
                       -0.08420333, 0.03491066, -0.06853954, -0.06313119, 0.09175989, 0.09901681, 0.07102823,
                       0.09995905, 0.0185295, 0.17216691, -0.10571937, 0.0330567, 0.01992384, 0.00190551, 0.06271085,
                       -0.1180279, -0.17295107, 0.07327658, 0.12559575, 0.07215359, 0.1370853, -0.10437324, 0.01392532,
                       -0.03951026, 0.06505746, -0.10967816, 0.0405759, 0.01218088, 0.14370835, -0.1345098, -0.18460356,
                       0.03693439, 0.02447971, 0.19783624, -0.20237383, -0.13626619, -0.01640069, -0.01358972,
                       -0.08245387, -0.04639382, 0.04513535, 0.00344232, -0.03673136, -0.0419205, 0.06469718,
                       -0.04706305, 0.0911414, -0.039722, 0.06036593, -0.00191985, 0.15681823, -0.17590025, 0.05609906,
                       0.09188047, -0.03787623, -0.0099665, -0.15099782, -0.01807624, -0.06215313, 0.10003554,
                       0.04558174, 0.05218956, -0.03214299, 0.05520668, 0.26121172, -0.03911012, 0.00638303, 0.04038787,
                       0.00450442, -0.08433981, -0.10387433, -0.00378972, 0.09613182, -0.06802271, 0.04632727,
                       -0.03040413, -0.13055128, -0.09280071, 0.13631295, -0.02089669, -0.01868439, 0.06367049,
                       0.03590139, 0.01073458, 0.04100137, -0.03886262, 0.02876895, -0.07511872, -0.02234573,
                       -0.09436331, 0.05623285, -0.03438602, -0.07730971, 0.03775893, -0.08562097, -0.06526889,
                       -0.0026733, -0.11433636],
                   2: [-0.036904756, -0.0591746867, -0.198489249, -0.00124493858, -0.138204381, 0.0732639208,
                       -0.11360842, -0.0238012634, -0.135894686, 0.0763416216, 0.0859029219, 0.021051839, -0.0747525766,
                       -0.11044506, 0.049786374, 0.0504598394, -0.0577579029, 0.0106204441, -0.00779819861,
                       -0.0480827205, -0.0958895981, -0.136503264, 0.166500494, -0.0588208921, -0.123637661,
                       0.0414091945, -0.0469403714, -0.0774255097, -0.0979274362, 0.0586439855, 0.000439832802,
                       -0.0217495356, 0.020265121, -0.120372787, 0.0405507535, 0.0369806066, 0.0680154189, 0.0242626276,
                       -0.0574019365, 0.0694982931, 0.0957853943, -0.00826485455, -0.000155600021, -0.00613875175,
                       0.109209813, -0.107444189, -0.139128014, 0.0345543697, -0.0133507019, 0.00588043965, 0.038896855,
                       0.0184581149, 0.0336641967, -0.183458894, 0.0469570272, -0.069119066, 0.0573729128, -0.053802304,
                       -0.132012591, 0.0380004868, -0.16423811, -0.0164434351, 0.0264873672, 0.013064892, -0.044216238,
                       0.0379694328, 0.0600564182, 0.0523538701, -0.129202068, 0.00682840496, 0.0784562826, 0.239719138,
                       0.0236426629, -0.109909154, 0.0467222892, -0.124245048, 0.0562669225, -0.0879328325,
                       -0.0965211242, 0.0385389514, 0.142922997, -0.053369876, 0.00677760877, -0.034354087,
                       0.00194539758, 0.0484173596, 0.10148754, 0.122297555, -0.0529475808, -0.212347686, 0.118677333,
                       0.0567373261, 0.0528660789, 0.0748900697, -0.0672963634, -0.0683943704, -0.0798600167,
                       -0.115761399, 0.127087474, -0.0618215278, 0.00161025871, -0.14917776, 0.0711981356, 0.0609671921,
                       -0.0211002603, 0.0610039458, 0.0483979918, 0.041055508, 0.0920775458, -0.0708900169,
                       -0.107850157, -0.109846331, -0.0537139736, 0.0252267364, 0.249335513, -0.0156867094, 0.169583201,
                       0.103515007, -0.00220156205, -0.168439731, -0.0580607578, 0.0753207505, -0.018377481,
                       -0.139992833, -0.0962089077, -0.0874797553, -0.0575956479, -0.0400589556],
                   3: [-0.0623888, 0.12458397, -0.05101817, -0.02460659, -0.07390679, 0.11278703, -0.0011263,
                       0.07182375, 0.06809578, 0.17289424, -0.01197863, -0.11116614, -0.09320373, -0.03373765,
                       0.04144284, 0.05053663, 0.02889443, -0.09921702, -0.15439463, -0.16391839, -0.03604342,
                       -0.00904823, 0.03762869, -0.09403772, 0.00693451, 0.03888452, -0.06751313, 0.04687995,
                       0.00863121, 0.13036582, 0.08299732, 0.06504445, 0.04918586, 0.00890279, 0.08298338, -0.14136842,
                       0.07810388, 0.02598245, -0.04080644, 0.17933816, 0.04874109, 0.06801192, 0.14360097, -0.06928983,
                       -0.05860284, -0.12569098, -0.08594526, 0.04428303, -0.00799668, 0.02433678, 0.04047016,
                       -0.1238642, 0.18720683, 0.14992297, -0.0776685, 0.02209961, -0.0865372, 0.08496702, -0.01859949,
                       -0.08974579, -0.15923484, 0.05401715, -0.01425619, -0.06152608, -0.02481306, -0.10826514,
                       -0.08342938, -0.1045061, -0.04503865, 0.02193313, -0.10539373, 0.08621015, -0.06975433,
                       0.05052676, -0.03268332, -0.11724335, 0.13348699, 0.00926389, -0.04831411, 0.08542475,
                       0.20705166, 0.06955365, 0.13661781, 0.0772744, -0.0701291, 0.06718516, 0.2425256, 0.01200363,
                       -0.02849262, 0.13173683, 0.04801257, -0.14145602, -0.00803793, 0.07505348, 0.14855856,
                       0.06699435, -0.1127027, 0.01203094, 0.02841985, -0.09171623, 0.11375316, -0.1396701, 0.14858952,
                       -0.0241371, -0.14633344, 0.02625597, -0.10542872, -0.06864624, -0.06006385, -0.06218014,
                       -0.09775937, 0.1413603, 0.03502044, -0.06708285, 0.08087538, 0.04217322, 0.00781382, -0.07795151,
                       0.02879408, 0.05875373, 0.01950694, 0.03064166, 0.04948168, 0.04430793, -0.07962796, -0.08547108,
                       -0.01808424, -0.06744486],
                   4: [-0.15608594, -0.13630775, -0.09024252, -0.01031573, -0.03848717, 0.03942759, -0.09969436,
                       -0.16044095, -0.03584691, 0.12414797, -0.06675501, -0.00877491, -0.05196223, -0.11293076,
                       -0.10214416, 0.08707222, 0.11691757, -0.0720342, 0.01104383, -0.0442728, -0.01756663, 0.04210982,
                       0.10875356, -0.22477369, -0.00066645, -0.07872096, -0.02035959, 0.02033638, -0.05333764,
                       -0.00207529, 0.10482424, 0.11193943, 0.0755237, -0.07057304, 0.01378143, -0.0188258, 0.11819856,
                       0.06487374, 0.09705982, 0.12052346, -0.09671427, -0.07888168, 0.13462311, -0.10180206,
                       -0.03900176, -0.16789937, -0.10887821, 0.00282961, 0.01618548, 0.0953491, 0.15978745,
                       -0.02777803, 0.09444954, -0.01628912, -0.04274305, -0.0448881, -0.07256071, -0.01557414,
                       0.01436011, -0.01750631, -0.09542709, -0.07916109, 0.21263915, 0.08640732, -0.00800685,
                       0.02893448, 0.04243796, 0.00043953, -0.06854989, 0.07082047, 0.03989948, 0.06659603, -0.00978144,
                       0.02706674, -0.08459795, -0.06132463, -0.02837783, -0.06628504, 0.01783054, -0.0155365, 0.231963,
                       -0.03378623, 0.13192068, 0.13117412, 0.04079271, 0.10246138, 0.0235926, 0.10443021, -0.01934449,
                       -0.04044594, -0.06580134, -0.0282714, -0.08058625, 0.13554908, 0.08246117, -0.06401521,
                       -0.01184042, -0.06521092, 0.03127161, 0.01863332, -0.0761794, -0.05750092, -0.01603531,
                       -0.00209489, -0.1515168, -0.03290317, -0.02374708, -0.1531384, -0.09833343, 0.12139563,
                       -0.07272466, 0.06300632, -0.00285429, -0.05741828, 0.2233427, -0.1017186, 0.09460921, 0.10719257,
                       -0.05145422, -0.1617367, -0.02520546, 0.06378692, -0.11973143, 0.05396657, -0.16272472,
                       -0.15033798, -0.0288353, -0.03719768],
                   5: [-0.1156845, -0.01677493, -0.14745839, 0.07172852, -0.05917578, 0.14197674, 0.00665697,
                       0.00110967, 0.01919534, 0.1419423, -0.03617828, -0.08261958, -0.02383357, -0.06292784,
                       -0.0391252, 0.09891809, 0.15151599, 0.13199519, -0.13046968, -0.10595147, -0.11537965,
                       0.05699734, 0.02725613, -0.0171315, -0.11275314, -0.05229898, -0.0345105, 0.03746977, 0.0247593,
                       -0.05476667, 0.12787253, 0.15808365, 0.0648691, 0.0603102, 0.07511491, 0.03476948, 0.10775784,
                       -0.06127455, 0.04555292, 0.17645535, -0.05220962, -0.0058021, -0.04977178, 0.10516368,
                       -0.01559502, 0.05446804, -0.11449201, 0.05012178, 0.09408651, 0.14986433, 0.02773212,
                       -0.14570288, 0.16344, -0.01903759, 0.00132055, -0.07618624, -0.05114096, 0.15409073, 0.15862323,
                       -0.0604077, -0.25845915, 0.04128416, -0.00352764, 0.08421349, -0.09009867, 0.00426554,
                       0.03132791, 0.04653918, -0.00794134, 0.08425555, -0.00904208, 0.15058921, 0.01352393,
                       -0.05787258, 0.07249406, -0.10565912, -0.04679362, -0.05982492, -0.05894162, 0.11426916,
                       0.14449492, -0.1502744, 0.10757221, 0.15653908, 0.02119962, 0.02176866, 0.17425361, 0.02512743,
                       -0.14956516, 0.02485819, -0.0222646, -0.04602109, -0.13056105, -0.00868009, 0.13428, -0.05496749,
                       0.04038727, 0.03581682, -0.05293164, -0.04361403, 0.02655016, -0.1803941, 0.10244296,
                       -0.06988281, -0.12579414, -0.08440048, -0.00843049, -0.05448516, 0.00116446, 0.12805633,
                       -0.02652246, 0.05043512, -0.05134612, 0.02660661, 0.12060036, -0.02295033, 0.09438127,
                       0.08275622, -0.0677864, 0.03056162, 0.08741587, -0.04170658, -0.0356356, -0.08575242, 0.00769574,
                       0.04045195, -0.05192611, -0.06316958],
                   6: [-0.05910637, -0.17061959, -0.03493192, -0.0446358, -0.164069, -0.03483016, 0.029429, -0.02563387,
                       -0.07494842, -0.0474322, 0.09046917, -0.1458398, 0.06093977, 0.00267345, -0.08394504,
                       -0.07708123, 0.03861308, 0.1337435, -0.00149326, -0.05911176, -0.10082687, -0.07839502,
                       0.15209545, -0.16731897, -0.02219875, 0.02774536, -0.13939212, -0.10950951, 0.08380035,
                       0.16165201, -0.10018647, -0.05943261, -0.02370048, -0.04633833, -0.08796342, -0.18382777,
                       0.12007637, -0.02016975, 0.06578797, 0.17091216, -0.06134745, -0.11615904, 0.02365247,
                       -0.1442371, 0.14664851, -0.0920447, -0.01365382, -0.14858659, -0.00442069, 0.03202132,
                       0.05810815, -0.07416918, -0.02369192, -0.030924, 0.00493149, -0.07383229, 0.04227635, 0.0453762,
                       -0.05568684, 0.07198799, -0.01656079, 0.07780492, 0.10414714, 0.06269212, 0.06239272, -0.178939,
                       -0.07903724, -0.0387192, -0.00242257, -0.06044897, -0.01306748, -0.00443926, -0.07012804,
                       -0.13769543, -0.09274022, -0.03376084, 0.05951497, -0.09567196, -0.02248341, 0.03729752,
                       0.06192749, 0.09921643, 0.01698312, 0.12220392, 0.10953691, 0.05077097, 0.01447598, -0.0678617,
                       -0.06021025, -0.17812486, -0.01795737, -0.06429759, -0.01315324, 0.15651959, 0.09739061,
                       -0.05814005, 0.16040866, -0.14878894, -0.00843838, 0.05831442, 0.10880773, -0.02910898,
                       0.04643653, 0.0847822, 0.024742, 0.08903921, -0.05979813, -0.07874166, 0.00629277, 0.11638567,
                       0.07293411, 0.02278649, -0.07900465, -0.10201267, 0.09697523, -0.1084538, 0.06618891, 0.06894051,
                       0.04824736, 0.07127766, -0.08336551, 0.17419644, -0.10366898, -0.03267086, -0.15716349,
                       -0.09762516, 0.00547169, -0.08343821],
                   7: [-0.03607243, 0.11771064, -0.16013582, 0.02087707, -0.10649044, -0.01526051, -0.00230419,
                       0.0063159, -0.04287092, -0.00109251, -0.07229529, -0.14009276, -0.08315272, -0.06717723,
                       -0.00930391, 0.08942011, 0.14970525, -0.04719615, -0.0987919, -0.18211535, 0.00491538,
                       -0.06152966, 0.09999198, -0.05996751, 0.01696618, -0.14343098, -0.13424793, 0.00052394,
                       0.02664837, 0.00672483, -0.10033038, -0.01515098, 0.03537332, -0.06260627, 0.03488327,
                       0.01381466, 0.01911912, -0.08407967, 0.07527518, 0.12674722, 0.06789372, 0.09957463, 0.03792046,
                       -0.01937518, -0.13600013, -0.07593448, -0.04182879, -0.01193065, 0.01381954, -0.00487721,
                       0.03883753, -0.09579046, 0.10111687, -0.03835231, -0.08637655, -0.00083055, -0.11953143,
                       0.07498748, 0.13511455, -0.07702756, -0.18491504, 0.0800415, 0.04486756, 0.07892425, -0.09299669,
                       -0.03215104, -0.04557713, -0.02536476, -0.07285148, -0.02388892, -0.08765381, 0.10302613,
                       0.14223291, 0.0717204, 0.00429587, -0.16198099, 0.04780789, 0.0600955, 0.01353999, 0.07117316,
                       0.14422315, -0.02048372, -0.011501, 0.05514419, -0.01378126, 0.09201328, 0.2860877, -0.08498394,
                       -0.11758476, 0.07833119, 0.00300488, -0.06437241, -0.19029267, 0.09276076, 0.12216754,
                       -0.04950727, -0.05599364, 0.10267862, 0.09505451, 0.0474454, 0.11011676, -0.16596237, 0.03705818,
                       -0.0599824, -0.00707624, 0.04492601, 0.05289628, 0.01354025, -0.04212701, -0.03690396,
                       -0.03507867, 0.2219326, -0.08908753, -0.07424671, 0.14783125, -0.05495722, 0.07544327,
                       -0.09146109, 0.0635581, 0.05740916, 0.05913333, 0.0463252, -0.10739645, 0.01938622, 0.00942617,
                       -0.1367345, -0.15929618, -0.08556497],
                   8: [-0.08624435, -0.14159684, 0.03442436, 0.08935273, 0.03430514, 0.11620704, -0.04643119,
                       -0.01994648, -0.06076298, 0.08579069, 0.0078998, -0.03671747, -0.09084661, -0.12276799,
                       -0.06644978, -0.0230305, 0.21501571, 0.05296341, -0.00959322, -0.12551625, -0.08988008,
                       0.09486122, 0.04681054, -0.22944863, 0.00560631, 0.09267712, -0.08580896, -0.0110154, 0.08611664,
                       0.12608826, 0.1219294, 0.17681888, -0.09458811, -0.14227217, -0.11296272, -0.08103953,
                       -0.03394707, -0.1379923, -0.02735105, -0.04421589, -0.01626281, 0.0929258, 0.05084068,
                       0.00818191, -0.09046073, 0.00310884, -0.08010826, -0.03440203, -0.0050771, 0.19016846,
                       -0.07696081, 0.07167944, 0.02073871, -0.06541511, 0.02098688, -0.0220386, -0.06796961,
                       0.02957797, -0.04752869, -0.13430174, -0.21634069, 0.08538375, 0.09342247, 0.04676294, 0.0083824,
                       0.03993696, 0.01512182, -0.04180586, -0.03716485, 0.04168469, 0.01240269, -0.13904528,
                       -0.11028267, -0.06119001, -0.10935003, 0.00717965, 0.09218618, 0.04118499, -0.13492677,
                       0.12651056, 0.06875857, -0.02976601, -0.03579796, 0.148781, -0.02904404, -0.03303402,
                       -0.07059732, 0.10880304, 0.12001608, -0.12650393, -0.03177816, 0.12798488, -0.08317975,
                       0.04649518, 0.10923282, -0.08148265, 0.13236363, 0.01714888, 0.06735276, -0.05336542,
                       -0.08533941, -0.04887183, -0.01703588, 0.08316389, -0.12614173, 0.08113971, -0.06315557,
                       0.03712284, 0.02341286, 0.06842307, -0.11228108, -0.06868479, 0.06900594, -0.17918049,
                       0.11679819, -0.0363408, 0.06667243, -0.08822413, 0.01093383, -0.05804089, 0.10296443,
                       -0.08108921, -0.00756661, 0.04381705, -0.11483315, -0.13469817, -0.09058073, 0.00690113],
                   9: [-0.00613215, -0.08161269, 0.0622548, 0.09575436, -0.19879778, -0.01008923, -0.07935673,
                       -0.1179664, 0.135491, 0.15484734, 0.00175781, -0.00050385, -0.04552767, -0.07860475, -0.00749832,
                       -0.03880333, -0.03134023, -0.02793242, -0.05318601, -0.04989224, -0.13404882, 0.10744192,
                       0.13192187, -0.06212045, -0.1624992, 0.04578501, 0.01016312, -0.040322, -0.10975767, 0.10623316,
                       -0.07646342, -0.04949467, -0.01636806, 0.11836325, 0.01249567, -0.04232557, 0.06790755,
                       -0.01156949, 0.06972283, 0.07045338, -0.05663411, -0.12906832, 0.01225218, 0.08415177,
                       -0.08984454, -0.04712469, 0.06123506, 0.07698651, -0.09870903, -0.09323513, 0.12122218,
                       -0.04360841, 0.17778435, 0.03947368, -0.1794127, 0.10087636, 0.11162029, -0.07453308,
                       -0.04578138, 0.07009847, -0.13293344, -0.11340539, 0.23096386, -0.01340361, -0.06983326,
                       0.00622289, -0.0812719, -0.02485036, 0.02709554, 0.14455134, 0.10644721, -0.09416497, 0.07487969,
                       -0.0213682, 0.0160287, -0.160968, 0.07652619, -0.06064299, -0.00555189, 0.15462713, 0.02818989,
                       -0.14608951, 0.1342987, 0.04223884, 0.03220193, -0.03910263, -0.01351057, 0.12315552,
                       -0.02474001, -0.03637764, 0.03009664, -0.00928453, 0.00953354, 0.03227077, -0.02564687,
                       0.0251914, 0.0117863, 0.09732705, 0.05646952, 0.06970638, -0.08306289, -0.04103654, 0.10247303,
                       0.10178611, -0.12157212, -0.04160667, 0.0116763, -0.11517147, 0.09376109, -0.07489844,
                       -0.16193208, 0.0488856, -0.10717996, -0.0821389, 0.00638758, 0.08167958, -0.05193452,
                       -0.02973824, -0.11891212, -0.12806575, -0.03424589, 0.12881589, -0.03249567, 0.08888885,
                       -0.00535293, -0.04914046, -0.18313706, -0.15603906],
                   10: [-0.1156845, -0.01677493, -0.14745839, 0.07172852, -0.05917578, 0.14197674, 0.00665697,
                        0.00110967, 0.01919534, 0.1419423, -0.03617828, -0.08261958, -0.02383357, -0.06292784,
                        -0.0391252, 0.09891809, 0.15151599, 0.13199519, -0.13046968, -0.10595147, -0.11537965,
                        0.05699734, 0.02725613, -0.0171315, -0.11275314, -0.05229898, -0.0345105, 0.03746977, 0.0247593,
                        -0.05476667, 0.12787253, 0.15808365, 0.0648691, 0.0603102, 0.07511491, 0.03476948, 0.10775784,
                        -0.06127455, 0.04555292, 0.17645535, -0.05220962, -0.0058021, -0.04977178, 0.10516368,
                        -0.01559502, 0.05446804, -0.11449201, 0.05012178, 0.09408651, 0.14986433, 0.02773212,
                        -0.14570288, 0.16344, -0.01903759, 0.00132055, -0.07618624, -0.05114096, 0.15409073, 0.15862323,
                        -0.0604077, -0.25845915, 0.04128416, -0.00352764, 0.08421349, -0.09009867, 0.00426554,
                        0.03132791, 0.04653918, -0.00794134, 0.08425555, -0.00904208, 0.15058921, 0.01352393,
                        -0.05787258, 0.07249406, -0.10565912, -0.04679362, -0.05982492, -0.05894162, 0.11426916,
                        0.14449492, -0.1502744, 0.10757221, 0.15653908, 0.02119962, 0.02176866, 0.17425361, 0.02512743,
                        -0.14956516, 0.02485819, -0.0222646, -0.04602109, -0.13056105, -0.00868009, 0.13428,
                        -0.05496749, 0.04038727, 0.03581682, -0.05293164, -0.04361403, 0.02655016, -0.1803941,
                        0.10244296, -0.06988281, -0.12579414, -0.08440048, -0.00843049, -0.05448516, 0.00116446,
                        0.12805633, -0.02652246, 0.05043512, -0.05134612, 0.02660661, 0.12060036, -0.02295033,
                        0.09438127, 0.08275622, -0.0677864, 0.03056162, 0.08741587, -0.04170658, -0.0356356,
                        -0.08575242, 0.00769574, 0.04045195, -0.05192611, -0.06316958],
                   11: [-0.08368768, 0.0206698, 0.06194579, 0.07218108, 0.01337951, 0.08957793, -0.07458658, 0.08305793,
                        -0.0503727, 0.17903516, 0.07905276, -0.0987028, -0.01290067, -0.1271241, 0.11926946, 0.01288191,
                        0.18226255, -0.02701507, 0.09074863, -0.13643377, 0.079367, -0.06826605, 0.01739745,
                        -0.00804328, 0.11881362, 0.08044159, -0.0224254, -0.07947645, -0.13374263, 0.17690577,
                        -0.1583107, 0.04032539, 0.08336859, -0.12237614, 0.02304759, 0.0809731, 0.15042526, -0.06957138,
                        -0.09082317, 0.06082796, -0.09399761, -0.00161769, 0.06559937, 0.01592825, -0.02740768,
                        -0.09363535, -0.00772057, -0.04713335, -0.01533412, 0.00346636, 0.0819331, -0.04639223,
                        -0.00313599, -0.04717727, 0.04896533, -0.06539678, 0.068907, -0.07346408, -0.08639739,
                        -0.0861342, -0.14270772, 0.06438818, 0.13060677, -0.07473972, 0.04003568, -0.04743105,
                        -0.05061611, 0.0486855, -0.15881103, 0.07043577, -0.09227621, -0.09937339, -0.07694408,
                        -0.02372144, -0.14164148, 0.03695538, -0.0068597, -0.14129831, -0.0964554, -0.00480097,
                        0.15913083, -0.0815959, -0.05279434, 0.13500428, 0.12266084, -0.06831677, 0.1708174, 0.10343923,
                        0.06790193, -0.01458678, -0.07906163, -0.14068708, 0.0115303, -0.08915627, 0.08003945,
                        -0.01486084, -0.10453738, 0.03095308, 0.13485384, 0.03762993, 0.01792461, -0.10084413,
                        -0.08010153, -0.03543254, -0.09102251, 0.02249796, -0.08997169, 0.0080516, -0.03317503,
                        0.10898453, -0.13123465, 0.08441053, -0.08374792, -0.03867108, 0.1896918, -0.15255426,
                        0.00934773, 0.06013241, 0.04817687, -0.12133043, 0.01141943, 0.12083139, 0.0550611, 0.09359311,
                        0.09313688, 0.01065253, 0.11393031, 0.093937],
                   12: [-0.18982272, 0.08282848, -0.02569667, 0.10485898, 0.05351452, 0.01006923, 0.0897344,
                        -0.02977388, 0.02141597, 0.00550188, -0.12422246, -0.10389031, -0.01930491, -0.1897779,
                        -0.01111048, 0.17803021, 0.02629523, 0.08407608, 0.07718014, 0.11067225, -0.05913948,
                        -0.06903062, -0.08414636, -0.06382234, -0.12125832, 0.14532788, -0.08041914, 0.0169403,
                        -0.08373135, 0.09536204, -0.09159113, -0.05945464, 0.12510021, -0.04658814, 0.08815966,
                        -0.11822985, 0.19678712, -0.13295828, 0.12212299, 0.02873004, 0.05700898, 0.06207822, 0.1288711,
                        -0.1251817, 0.05671353, 0.0295833, 0.00647254, 0.06021943, -0.0431199, -0.0646811, 0.05879055,
                        0.00325082, 0.13245858, -0.14020817, -0.0945695, -0.06305443, -0.09152227, -0.02721204,
                        0.08970748, 0.09809443, -0.13914081, -0.14581604, -0.00465249, 0.1082207, -0.12076829,
                        0.09189709, -0.03064352, 0.08449207, -0.01393183, -0.01523035, -0.08229603, 0.0671076,
                        -0.07229723, 0.05243944, -0.0395259, -0.03705312, 0.06537875, -0.14801049, 0.00892898,
                        0.06904714, -0.01461761, -0.13399218, 0.06279884, 0.07870992, -0.04019105, -0.06302071,
                        -0.05926177, -0.07714317, 0.11257824, 0.02618554, 0.04159993, -0.0616165, 0.02317164,
                        0.08352047, 0.12782463, -0.13406962, 0.05108871, 0.02100158, 0.05133975, -0.10826997,
                        -0.12790479, -0.00954359, -0.07399031, -0.1487382, -0.05876892, 0.14800997, -0.03151724,
                        -0.02311082, 0.0067355, 0.03885889, -0.1006763, 0.10708473, -0.09660848, -0.17360301,
                        0.01329772, -0.00455828, -0.09553105, -0.10424419, 0.07531702, -0.07270876, 0.07098097,
                        0.01964737, 0.00623204, -0.10472578, 0.03505291, -0.17794712, 0.01830581, -0.06635544],
                   13: [-0.0531891, -0.04063858, -0.15136571, 0.00641167, -0.05926864, -0.06665725, 0.00409394,
                        -0.01459478, 0.02766847, 0.06741302, 0.03488776, 0.09655166, 0.01220015, -0.18981178,
                        0.15122567, 0.06933161, 0.18879603, 0.05487739, -0.01046693, -0.10176883, 0.02825076,
                        0.10603386, 0.0359896, -0.07243113, 0.00367281, -0.02269922, -0.19179606, 0.0267348, 0.08626828,
                        0.0958809, 0.04484052, 0.12649722, -0.02912655, 0.1273112, 0.00049228, 0.03472815, 0.02231677,
                        -0.106396, -0.04583706, 0.13373514, -0.12973766, 0.13855128, 0.07400306, -0.06521901,
                        -0.01359204, -0.122343, -0.15037483, -0.08432923, 0.03378203, 0.02501275, 0.12176486,
                        0.03841607, 0.04261752, -0.01644713, -0.01632216, 0.08164387, -0.03155236, -0.06530877,
                        -0.01216242, -0.0760228, -0.14398505, 0.05900955, 0.03190676, 0.11396614, -0.00369715,
                        -0.02381507, -0.04871782, 0.07271048, -0.06958292, 0.02041738, 0.10950317, 0.11659779,
                        0.15181392, 0.064032, 0.10903682, -0.05859716, -0.06077413, 0.0313224, 0.08092746, 0.06922267,
                        -0.04092244, 0.053582, 0.15565692, 0.15131623, -0.14872994, 0.10486297, 0.13492206, -0.05118502,
                        0.02916914, 0.03014338, 0.05839015, 0.20634636, 0.04388826, 0.02770332, 0.06146295, 0.05276997,
                        0.08403038, 0.12298535, 0.1235872, 0.0872314, -0.02773289, 0.05141073, -0.03190766, 0.04696394,
                        0.11362378, 0.27538288, 0.04293549, -0.12352572, 0.08024428, 0.04988318, 0.04239679, 0.02173718,
                        -0.0808372, -0.08570502, 0.0976893, 0.06073395, -0.04329484, -0.0496586, -0.07484474,
                        -0.12047166, 0.06704558, 0.17453659, 0.01363065, -0.0527836, 0.03452551, -0.07625781, -0.02259,
                        0.03383248],
                   14: [-0.15109314, 0.0707949, 0.07293981, 0.06609563, -0.15768151, -0.03067984, -0.10758246,
                        -0.05517532, -0.08212823, 0.01249744, 0.02555595, 0.07747866, -0.09950858, -0.06268844,
                        0.10583011, 0.08042873, 0.06375678, -0.18254657, 0.11914457, -0.00874565, -0.05528316,
                        -0.05616629, 0.03221564, -0.21291588, -0.01376483, 0.03156358, 0.06996885, 0.07925594,
                        -0.02705966, 0.09494992, 0.17569493, 0.16912535, -0.08464517, 0.07528153, -0.01770568,
                        -0.03720004, 0.0849477, -0.01000404, -0.05356408, 0.08393123, -0.11138916, -0.08217327,
                        0.19011849, -0.03264992, 0.07596345, 0.08365018, -0.07296496, 0.04453377, 0.0222839, 0.0630748,
                        0.12122313, -0.03429219, -0.09206071, -0.00462873, -0.03053795, 0.11456854, -0.11410187,
                        0.09978443, -0.15160419, 0.02194059, -0.14843148, -0.1700279, 0.2138387, 0.06813569,
                        -0.17686458, 0.06642166, -0.08924732, -0.13088842, 0.02682026, -0.0610859, 0.03267029,
                        0.06290354, 0.03924519, -0.01238684, -0.10952917, -0.03748182, 0.01094893, 0.0127713,
                        -0.08682659, -0.08931246, 0.14992662, -0.05497041, 0.19966656, -0.00180715, -0.0606554,
                        -0.07091434, -0.01518775, -0.04255459, -0.01259899, -0.11977886, -0.10901403, -0.01374308,
                        0.0303617, -0.05532427, -0.02123572, 0.06113628, -0.09912659, 0.10670404, 0.14479543,
                        0.10247717, 0.04531043, 0.08009306, 0.10331969, 0.01899694, -0.09760923, -0.04147325,
                        0.03440616, 0.00447491, -0.09492881, -0.07337667, -0.12318338, -0.00885448, -0.10018028,
                        0.01579688, 0.02176914, -0.06122016, -0.03889966, 0.06700051, 0.01977237, -0.12023376,
                        0.06112786, -0.042896, -0.11775096, 0.0255, 0.02919981, -0.05890665, 0.03073981, -0.07265897],
                   15: [-0.1156845, -0.01677493, -0.14745839, 0.07172852, -0.05917578, 0.14197674, 0.00665697,
                        0.00110967, 0.01919534, 0.1419423, -0.03617828, -0.08261958, -0.02383357, -0.06292784,
                        -0.0391252, 0.09891809, 0.15151599, 0.13199519, -0.13046968, -0.10595147, -0.11537965,
                        0.05699734, 0.02725613, -0.0171315, -0.11275314, -0.05229898, -0.0345105, 0.03746977, 0.0247593,
                        -0.05476667, 0.12787253, 0.15808365, 0.0648691, 0.0603102, 0.07511491, 0.03476948, 0.10775784,
                        -0.06127455, 0.04555292, 0.17645535, -0.05220962, -0.0058021, -0.04977178, 0.10516368,
                        -0.01559502, 0.05446804, -0.11449201, 0.05012178, 0.09408651, 0.14986433, 0.02773212,
                        -0.14570288, 0.16344, -0.01903759, 0.00132055, -0.07618624, -0.05114096, 0.15409073, 0.15862323,
                        -0.0604077, -0.25845915, 0.04128416, -0.00352764, 0.08421349, -0.09009867, 0.00426554,
                        0.03132791, 0.04653918, -0.00794134, 0.08425555, -0.00904208, 0.15058921, 0.01352393,
                        -0.05787258, 0.07249406, -0.10565912, -0.04679362, -0.05982492, -0.05894162, 0.11426916,
                        0.14449492, -0.1502744, 0.10757221, 0.15653908, 0.02119962, 0.02176866, 0.17425361, 0.02512743,
                        -0.14956516, 0.02485819, -0.0222646, -0.04602109, -0.13056105, -0.00868009, 0.13428,
                        -0.05496749, 0.04038727, 0.03581682, -0.05293164, -0.04361403, 0.02655016, -0.1803941,
                        0.10244296, -0.06988281, -0.12579414, -0.08440048, -0.00843049, -0.05448516, 0.00116446,
                        0.12805633, -0.02652246, 0.05043512, -0.05134612, 0.02660661, 0.12060036, -0.02295033,
                        0.09438127, 0.08275622, -0.0677864, 0.03056162, 0.08741587, -0.04170658, -0.0356356,
                        -0.08575242, 0.00769574, 0.04045195, -0.05192611, -0.06316958],
                   16: [-0.10111258, -0.04814173, -0.10456679, 0.07986144, -0.18318202, -0.09200492, -0.01987985,
                        -0.00388456, -0.04794091, 0.09720176, -0.06723226, 0.04630779, -0.18678372, -0.04960915,
                        0.0267601, 0.06625049, 0.16692083, 0.00672437, -0.1277128, -0.09006409, -0.03896222, -0.1478282,
                        -0.04191182, -0.14969978, 0.03853168, 0.07060943, 0.02499253, -0.13033763, 0.13719162,
                        0.1057892, 0.1903158, 0.14227499, 0.08061974, -0.1307437, 0.10361063, 0.04137971, 0.02711639,
                        -0.09660491, 0.08331478, 0.0075785, -0.13914208, -0.02439337, 0.14915359, -0.10915608,
                        -0.12045211, 0.07789675, 0.02019261, -0.03734582, 0.02154638, 0.07013635, 0.15557076,
                        -0.0894224, -0.10779078, -0.04724295, -0.00080559, -0.028783, 0.03822725, -0.04681924,
                        0.04532248, 0.02673641, -0.18767744, 0.0923886, 0.19354014, -0.05608856, 0.04779956, 0.0919636,
                        0.0868732, 0.04785377, 0.07763643, 0.07163688, -0.03798958, 0.092637, -0.11023857, 0.01082355,
                        0.06961174, -0.00615499, 0.08643573, 0.00280667, -0.12373792, 0.17230316, 0.06593434,
                        0.09794658, 0.10365441, -0.06045251, 0.02935583, 0.00272235, 0.09656905, 0.14089505, 0.00264179,
                        -0.15507445, -0.02874526, 0.03472003, -0.01233279, 0.07723027, 0.05777219, 0.00505664,
                        -0.05525465, 0.09185824, 0.03796611, 0.01937738, 0.01997192, -0.06033514, 0.0846954, 0.05759916,
                        -0.03458814, -0.00383027, -0.05569966, -0.01694696, 0.02797833, -0.01188148, -0.20891987,
                        0.09325985, 0.06103189, -0.00348593, 0.11444847, -0.01662405, 0.07497559, -0.02030399,
                        0.11326737, -0.16994277, 0.00037987, 0.09020336, 0.01342891, 0.07921307, -0.04049298,
                        -0.08896823, 0.01243417, -0.05968302]}, 'topography': {}, 'topography_code': {},
               'morphology': {}, 'morphology_code': {}, 'topography_code_regex': {}, 'morphology_code_regex': {},
               'tnm_code': {}, 'clinical_medgen': {}, 'allergy_regex': {}, 'aspect_line': {},
               'aspect_enforce': {}, 'tumor_grade_code': {}, 'tumor_grade_terms': {},
               'latinizer': {3: [1, 0, 1, 0, 0, 0, 0, 0, 0, 0], 14: [0, 1, 0, 0, 0, 0, 1, 0, 0, 0]}, 'defaults': {
            'address': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                      0], 'header': [0],
            'drug_rxnorm': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'lab_hepc': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'clinical': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'person': [0], 'zipcode': [0], 'aspect': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'history': [0, 0, 0, 0, 0, 0, 0, 0, 0], 'polarity': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'severity': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0],
            'sectionizer': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                            0, 0, 0, 0, 0, 0, 0, 0, 0],
            'form': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'len': [0, 0, 0],
            'speech': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'speech_bin': [0, 0, 0, 0, 0, 0, 0, 0, 0],
            'header_aspect': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'case': [0, 0, 0],
            'tf_i2b2': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'tf_ccda': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'tf_mtsample': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'tf_mrconso': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'tf_npi_city': [0], 'tf_npi_address': [0],
            'tf_npi_phone': [0], 'tf_npi_first_name': [0], 'tf_npi_last_name': [0], 'tf_patient_first_name': [0],
            'tf_patient_last_name': [0], 'tf_cities': [0], 'tf_states': [0], 'tf_disorder': [0], 'tf_finding': [0],
            'tf_procedure': [0], 'smoking': [0, 0, 0, 0, 0],
            'clinical_code_icd9': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                   0, 0, 0],
            'clinical_code_icd10': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                    0, 0, 0],
            'clinical_general': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                 0],
            'clinical_snomed': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'regex_dates': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'date_comprehension': [0, 0, 0],
            'patient': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'problem': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'diagnosis': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'lab_loinc': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'word2vec_mimic': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'topography': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'topography_code': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0],
            'morphology': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'morphology_code': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0], 'topography_code_regex': [0, 0, 0], 'morphology_code_regex': [0, 0],
            'tnm_code': [0, 0, 0, 0, 0, 0, 0, 0],
            'clinical_medgen': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'latinizer': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'allergy_regex': [0],
            'aspect_line': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'aspect_enforce': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'tumor_grade_code': [0, 0],
            'tumor_grade_terms': [0, 0, 0, 0],
            'lab_hepc_attributes': [0, 0]
        }})

    def test_3d_matrix(self):
        max_window_size = 30
        features = [FeatureType[feature] for feature in self.VECTORS.defaults.to_dict()]

        mat, mapping = get_3d_matrix(self.VECTORS, len(self.TEST_TOKEN), max_window_size, feature_types=features)
        # assert dimensionality

        self.assertEqual(mat.shape[0], len(self.TEST_TOKEN.tokens))
        self.assertEqual(mat.shape[1], max_window_size)

        # assert the mapping file maps correctly.
        max_col = 0
        for feat, cols in mapping.items():
            #dont bother testing on document name
            if feat == FeatureType.document_type.name:
                continue
            if max(cols) > max_col:
                max_col = max(cols)

            if self.VECTORS[feat, 0] is not None:
                # assert first value is the same as the first token vectorized and matches column indexes
                self.assertTrue((numpy.array(self.VECTORS[feat, 0], dtype=numpy.float16) == mat[0, 0, cols]).all())

            # assert3rd vector is in the 3rd window slide for first entry

            if self.VECTORS[feat, 2] is not None:
                self.assertTrue((numpy.array(self.VECTORS[feat, 2], dtype=numpy.float16) == mat[0, 2, cols]).all())
                # assert 3rd vector is in the first window for 3rd token
                self.assertTrue((numpy.array(self.VECTORS[feat, 2], dtype=numpy.float16) == mat[2, 0, cols]).all())

        # assert that number of columns expected is size of matrix
        self.assertEqual(max_col, mat.shape[2] - 1)
